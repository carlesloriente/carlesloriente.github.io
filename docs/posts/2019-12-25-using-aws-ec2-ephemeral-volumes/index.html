<!DOCTYPE html>
<html class="h-100" lang="en" data-bs-theme="light">
  <head>
      <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Using ephemeral volumes in EC2</title>
  <meta name="description" content="In some of the AWS EC2 instances you can use an ephemeral volume, be careful with the data you plan to store in it, when the instance is restarted, stopped o...">
  <meta name="google-site-verification" content="imA3xlKv43a50bTrOlAa3eWQ3VBCazAY4Y20KImDXOM">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="godarthvader">
  <meta name="twitter:creator" content="godarthvader">
  <meta property="og:url" content="https://www.notesoncloudcomputing.com/posts/2019-12-25-using-aws-ec2-ephemeral-volumes/">
  <meta property="og:title" content="Using ephemeral volumes in EC2">
  <meta property="og:description" content="In some of the AWS EC2 instances you can use an ephemeral volume, be careful with the data you plan to store in it, when the instance is restarted, stopped o...">
  <meta property="og:image" content="https://www.notesoncloudcomputing.com/assets/images/bg-aws-logo.webp">
  <meta property="og:type" content="article">
  <link rel="stylesheet" href="/assets/vendor/nocc-bootstrap-theme/css/nocc-theme.min.css" type="text/css">
<link rel="stylesheet" href="/assets/css/styles.css" type="text/css">
  <link rel="canonical" href="https://www.notesoncloudcomputing.com/posts/2019-12-25-using-aws-ec2-ephemeral-volumes/">
  <link rel="alternate" type="application/rss+xml" title="Notes on Cloud Computing" href="/feed.xml">
  <link rel="shortcut icon" href="/assets/images/favicon_io/favicon.ico">
  <link rel="icon" href="/assets/images/favicon_io/favicon.ico" sizes="any">
  <link rel="icon" href="/assets/images/favicon_io/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/assets/images/favicon_io/favicon.png" type="image/png">
  <link rel="manifest" href="/manifest.webmanifest"><!-- Global site tag (gtag.js) - Google Analytics -->
<script type="text/javascript" async src="https://www.googletagmanager.com/gtag/js?id=G-YZN6D91Z4N" ></script>
<script type="text/javascript">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YZN6D91Z4N', {cookie_flags: 'SameSite=None;Secure'});
</script>
</head>
  <body class="d-flex flex-column h-100" style="overflow-x: hidden;">
    <header>
        <div class="position-fixed bottom-0 end-0 mb-3 me-3">
      <button class="btn-toggle py-2 d-flex align-items-center" id="bd-toggle" data-bs-toggle="button" type="button" aria-expanded="false" aria-label="Toggle theme color">
        <span class="daylight filter-white"></span>
      </button>
    </div>
    <script type="text/javascript" src="/assets/vendor/nocc-bootstrap-theme/js/theme-toggler.min.js"></script>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand" hreflang="en" href="/">Notes on Cloud Computing</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarResponsive">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" hreflang="en" href="/" aria-label="Notes on Cloud Computing Home">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" hreflang="en" href="/about/" aria-label="Notes on Cloud Computing About">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" hreflang="en" href="/posts/" aria-label="Notes on Cloud Computing Posts">Posts</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" hreflang="en" href="/tags/" aria-label="Notes on Cloud Computing Tags">Tags</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" hreflang="en" href="/gallery/" aria-label="Notes on Cloud Computing Gallery of images">Gallery</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" hreflang="en" href="/contact/" aria-label="Notes on Cloud Computing Contact form">Contact</a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/carlesloriente/carlesloriente.github.io" target="_blank" hreflang="en" rel="noreferrer" class="nx-p-2 nx-text-current"><img class="nav-github" alt="NotesOnCloudComputing Github repo stars" src="https://img.shields.io/github/stars/carlesloriente/carlesloriente.github.io?style=social"></a>
            </li>
            <li class="nav-item">
              <a href="https://ko-fi.com/S6S1O2GTU" target="_blank" hreflang="en" rel="noopener" title="Support me on ko-fi.com"><img class="nav-kofi" src="/assets/vendor/nocc-bootstrap-theme/images/nocc/kofi_s_logo_nolabel.webp" border="0" alt="Buy Me a Coffee at ko-fi.com" /></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    </header>
  <main class="flex-shrink-0">
  
  <section class="masthead sechead" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0.5)0%,rgba(0,0,0,0.5) 100%), url('/assets/images/bg-aws-logo.webp')">
  
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class=" mx-auto">
          <div class="post-heading">
            <h1 class="mx-auto">Using ephemeral volumes in EC2</h1>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section>
    <div class="container my-4">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <div class="meta text-center">Posted by
            <a href="/about/" hreflang="en" aria-label="Author">Carles Loriente </a>  on December 25, 2019 &middot; <span class="reading-time" title="Estimated read time"> 1 min  read</span>
</div>
          <hr class="border border-primary opacity-25">
          <p>In some of the AWS EC2 instances you can use an ephemeral volume, be careful with the data you plan to store in it, when the instance is restarted, stopped or terminated all the data is permanently deleted</p>

<p>You can check the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html" target="_blank">complete list</a> of EC2 instances with ephemeral volumes and his types.</p>

<p>Some of them will require to install an additinal package to use it.</p>

<p>For this example we are going to launch a g4dn.xlarge with CentOS 7 using the AWS Console, as you can see in “Step 7: Review Instance Launch”.</p>

<p><img src="/assets/images/instance-storage-disk.jpg" alt="Storage" /></p>

<p>There are two volumes, one EBS and one Ephemeral.</p>

<p>Connect to the instance using SSH and use the df-h command to view the volumes that are formatted and mounted.</p>

<p><img src="/assets/images/df-h.jpg" alt="df -h" /></p>

<p>Use the lsblk to view any volumes that were mapped at launch but not formatted and mounted</p>

<p><img src="/assets/images/lsblk.jpg" alt="lsblk" /></p>

<p>As you can see, the name of the ephemeral volume is nvme1n1, so we can move forward and format and mount it, but before that we are going to install the package nvme-cli.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight "><button type="button" class="btn-clipboard float-end tooltip" aria-label="Copy to clipboard" data-bs-original-title="Copy to clipboard"><span class="tooltiptext">Copy to clipboard</span><span class="clipboard filter-white"></span></button>
<code>sudo yum -y install nvme-cli;
sudo mkfs.xfs /dev/nvme1n1;
sudo mkdir -p /mnt/ephemeral;
sudo mount /dev/nvme1n1 /mnt/ephemeral;
sudo chown centos:centos /mnt/ephemeral;</code>
</pre></div>

<p>Download the GitHub Gist <a href="https://gist.github.com/carlesloriente/5dbd6acf64090bba9593146185c11183" target="_blank">format-and-mount-nvme-volumes.sh</a></p>

<p>Now we can use the ephemeral storage mounted at <code class="language-plaintext highlighter-rouge">/mnt/ephemeral</code>, e.g: for swapping/caching purposes (don’t to do that on EBS Volumes, cost and IOPS will be affected).</p>

          <hr>
          <div class="text-center">
            <p><mark>Found a snippet that saved your day?</mark> Consider <a href="https://ko-fi.com/S6S1O2GTU" target="_blank" rel="noopener" title="Support me on ko-fi.com">dropping a tip!</a></p>
            <script type="text/javascript" src="/assets/vendor/nocc-bootstrap-theme/js/ko-fi/widget_2.min.js"></script>
            <script type="text/javascript">kofiwidget2.init("Buy me a coffee", "#176391", "S6S1O2GTU");kofiwidget2.draw();</script>
          </div>
          <hr>
          <div class="clearfix">
            
              
                
  <div id="disqus_thread"></div>
  <p></p>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = 'https://www.notesoncloudcomputing.com/posts/2019-12-25-using-aws-ec2-ephemeral-volumes/';
      this.page.identifier = 'https://www.notesoncloudcomputing.com/posts/2019-12-25-using-aws-ec2-ephemeral-volumes/';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://notes-on-cloud-infrastructure.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

              
            
            
            <a class="btn btn-primary float-start" href="/posts/2019-12-23-fedora-fix-touchpad-msi-prestige/" hreflang="en" data-bs-toggle="tooltip" data-bs-placement="top" title="Fedora Fix touchpad MSI Prestige">&larr; Previous<span class="d-none d-md-inline">
                Post</span></a>
            
            
            <a class="btn btn-primary float-end" href="/posts/2019-12-26-create-swap-file/" hreflang="en" data-bs-toggle="tooltip" data-bs-placement="top" title="Create swap file in linux">Next<span class="d-none d-md-inline">
                Post</span> &rarr;</a>
            
          </div>
        </div>
      </div>
    </div>
    <div class="divider"></div>
  </section>
  </main>
  
    
<!-- Footer -->
<footer class="footer mt-auto">
  <div class="container">
    <ul class="list-inline text-center">
      <li class="list-inline-item rounded-circle">
        <a href="mailto:fi1nziulf@mozmail.com" hreflang="en" aria-label="fi1nziulf@mozmail.com address">
          <img class="filter-white" src="/assets/vendor/nocc-bootstrap-theme/icons/1.11.0/envelope-at-fill.svg" width="32px" height="32px" aria-hidden="true">
        </a>
      </li><li class="list-inline-item rounded-circle">
        <a href="https://twitter.com/godarthvader" hreflang="en" target="_blank" rel="noreferrer" aria-label="godarthvader Twitter">
          <img class="filter-white" src="/assets/vendor/nocc-bootstrap-theme/icons/1.11.0/twitter-x.svg" width="32px" height="32px" aria-hidden="true">
        </a>
      </li><li class="list-inline-item rounded-circle">
        <a href="https://www.linkedin.com/in/carles-loriente" hreflang="en" target="_blank" rel="noreferrer" aria-label="carles-loriente Linkedin">
          <img class="filter-white" src="/assets/vendor/nocc-bootstrap-theme/icons/1.11.0/linkedin.svg" width="32px" height="32px" aria-hidden="true">
        </a>
      </li><li class="list-inline-item rounded-circle">
        <a href="https://github.com/carlesloriente" hreflang="en" target="_blank" rel="noreferrer" aria-label="carlesloriente GitHub">
          <img class="filter-white" src="/assets/vendor/nocc-bootstrap-theme/icons/1.11.0/github.svg" width="32px" height="32px" aria-hidden="true">
        </a>
      </li></ul>
    <p class="copyright text-copyright">Copyright &copy; <a href="/about/" hreflang="en" aria-label="Notes on Cloud Computing author">Carles Loriente</a> 2024<br />
      <a href="https://bootstrap-theme.notesoncloudcomputing.com/" hreflang="en" target="_blank" rel="noreferrer" aria-label="NOCC Bootstrap Theme">NOCC Bootstrap Theme</a> v.1.2.0 created by <a href="https://www.notesoncloudcomputing.com/about/" hreflang="en" target="_blank" rel="noreferrer" aria-label="Autor website https://www.notesoncloudcomputing.com/about/">Carles Loriente</a><br />
      Build with <a href="https://jekyllrb.com" hreflang="en" target="_blank" rel="noreferrer" aria-label="Jekyll">Jekyll</a><br />
      Proudly hosted by <a href="https://github.com" hreflang="en" target="_blank" rel="noreferrer" aria-label="Github"><strong>GitHub</strong></a>
    </p>
  </div>
</footer>
    
<script type="text/javascript" rel="preload" src="/assets/vendor/nocc-bootstrap-theme/js/jquery/3.7.1/jquery.min.js"></script>
<script type="text/javascript" src="/assets/vendor/nocc-bootstrap-theme/js/clipboardjs/clipboard.min.js"></script>
<script type="text/javascript" src="/assets/vendor/nocc-bootstrap-theme/js/copy-clipboard.js"></script>
<script type="text/javascript" src="/assets/vendor/nocc-bootstrap-theme/js/bootstrap/5.3.3/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="https://notes-on-cloud-infrastructure.disqus.com/count.js" async id="dsq-count-scr"></script>
  </body>
</html>